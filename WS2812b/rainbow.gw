#import WS2812b

fun int color(int r, int g, int b) {
  return (r << 16) + (g << 8) + b;
}

fun int wheel(int pos) {
  if(pos < 85)
      return color(pos * 3, 255 - pos * 3, 0);
  if(pos < 170) {
      85 -=> pos;
      return color(255 - pos * 3, 0, pos * 3);
  }
  170 -=> pos;
  return color(0, pos * 3, 255 - pos * 3);
}

const WS2812b("/dev/spidev0.0", WS2812b.Mode.THREE, 10 000 000, 144) leds;

repeat(i, leds.n_leds)
  leds.set(i, wheel(i & 255));

leds.write();
